---
title:  "[OS] 운영체제의 스레드, CPU 스케줄링"
excerpt: "운영체제에 대해 학습한 내용을 정리하였습니다."

tags:
  - [Blog, OS]

toc: true
toc_sticky: true
 
date: 2023-05-24
last_modified_at: 2023-05-24

---

# 스레드

## 스레드 개념

- 프로세스 내에서 실행되는 흐름의 단위 혹은 CPU 스케줄링의 기본 단위
- 각 스레드는 자신의 stack 영역을 가지며, 동일한 프로세스의 code, data, heap영역을 공유한다.
- 한 프로세스를 여러개의 스레드로 동시 실행할 수 있다. (멀티스레드 프로세스)

## 멀티스레드의 구조

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdqBr2Z%2FbtriX7OJWvq%2FjBmQ6TMvLFWf65yQFLdNz0%2Fimg.png)

## 멀티 프로세스 vs 멀티 스레드

- 멀티 프로세스 
	- 여러 프로세스를 동시에 실행함
	- context switching 발생시 오버헤드가 크다. 
	- 프로세스간 통신이 까다롭다. (복잡한 IPC 사용)
	- 자식 프로세스 중 하나에 문제가 발생하면 해당 프로세스에만 이상이 생기고 타 프로세스에는 영향을 주지 않는다.
- 멀티 스레드
	- 여러 스레드로 프로세스 동시 실행
	- 시스템 자원 소모가 감소하며 자원의 효율적인 관리가 가능하다.
	- 스레드 간 통신이 간단하다. (프로세스 내 공유영역)
	- 동기화 문제가 발생할 수 있다. (프로세스 내 공유영역)
	- 디버깅이 까다롭다.


# CPU 스케줄링

- 운영체제가 프로세스들에게 공정하고 합리적으로 CPU 자원을 배분하기 위해 시행함
- 비선점 스케줄링 방식과 선점 스케줄링 방식이 있다.
- 비선점 스케줄링 방식에서는 
- 선점 스케줄링 방식에서는 우선순위를 부여해 이에 대해 오름차순으로 시행한다.
	- 유닉스 계열 운영체제에서는 `ps -el` 명령어를 통해 프로세스 우선순위를 확인할 수 있다.

## 장기 스케줄링

- 어떤 프로세스를 준비 큐에 넣을 것인지 결정한다. (=작업 스케줄러)
- 디스크에서 프로그램을 가져와 커널(준비 큐)에 등록할지 결정
- 메모리에 동시에 올라가 있는 프로세스의 수를 조정

## 중기 스케줄링

- 메모리에 적재된 프로세스 수 관리
- 너무 많은 프로스스에게 메모리를 할당해 시스템의 성능이 저하되는 현상을 해결하기 위해 메모리에 적재된 프로세스의 수를 동적으로 조절한다.
- 스왑 아웃 
	- 프로세스가 메모리에서 일정 시간 동안 실행되고 있는 상태에서 메모리에서 제거되어 디스크에 저장되는 것
	- 중기 스케줄링은 프로세스의 상태에 중지 상태가 추가되며, 중지 상태의 프로세스는 메모리를 통째로 빼앗기고 디스크로 스왑 아웃된다.
	- 봉쇄 상태에 있는 프로세스들을 첫번째로 스왑 아웃 시킨다.
- 중기 스케줄러의 등장으로 프로세스의 상태에 중지 상태가 추가되었다.

- 중지 준비 상태 : 준비 상태의 프로세스가 중기 스케줄러에 의해 디스크로 swap out
- 봉쇄 중지 상태 : 봉쇄 상태의 프로세스가 중기 스케줄러에 의해 디스크로 swap out

- 중지 봉쇄 상태이던 프로세스가 봉쇄 조건을 만족하게 되면 이 프로세스의 상태는 중지 준비 상태로 바뀌게 된다.
- 중지 상태에 있는 프로세스들은 중지 준비 상태이든 중지 봉쇄 상태이든 관계없이 메모리를 조금도 보유하지 않고 디스크에 통째로 **스왑 아웃된 상태**로 존재하게 된다.

## 단기 스케줄링

- 어떤 프로세스에 CPU를 할당해 줄 것인지 결정한다. (=CPU 스케쥴러)
- 미리 정한 스케줄링 알고리즘에 따라 CPU를 할당할 프로세스를 선택한다.
- 빈번하게 호출되기 때문에 수행 속도가 충분히 빨라야 한다.